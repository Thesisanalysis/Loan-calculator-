<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indian Loan Calculator</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
<style>
    :root {
      --primary: #4361ee;
      --secondary: #3a0ca3;
      --accent: #f72585;
      --light: #f8f9fa;
      --dark: #212529;
      --success: #4cc9f0;
      --warning: #f9c74f;
      --danger: #f94144;
      --gray: #6c757d;
      --border-radius: 16px;
      --box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      --transition: all 0.3s ease;
    }

    body {
      font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
      margin: 0;
      padding: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
    }

    .loan-calculator-container {
      font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
      background: white;
      border-radius: var(--border-radius);
      box-shadow: var(--box-shadow);
      width: 100%;
      max-width: 500px;
      margin: 20px auto;
      overflow: hidden;
      transition: var(--transition);
      color: var(--dark);
    }

    .loan-calculator-container:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
    }

    .loan-calculator-header {
      background: linear-gradient(to right, var(--primary), var(--secondary));
      color: white;
      padding: 25px;
      text-align: center;
    }

    .loan-calculator-header h1 {
      font-weight: 600;
      font-size: 1.8rem;
      margin-bottom: 5px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      margin-top: 0;
    }

    .loan-calculator-header p {
      opacity: 0.9;
      font-size: 0.95rem;
      margin: 0;
    }

    .loan-calculator-content {
      padding: 25px;
    }

    .input-group {
      margin-bottom: 20px;
      position: relative;
    }

    .input-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: var(--dark);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .input-wrapper {
      position: relative;
    }

    .input-wrapper i {
      position: absolute;
      left: 15px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--gray);
      z-index: 1;
    }

    .loan-calculator-container input,
    .loan-calculator-container select {
      width: 100%;
      padding: 14px;
      border: 2px solid #e9ecef;
      border-radius: 12px;
      font-size: 16px;
      transition: var(--transition);
      background: var(--light);
      padding-left: 45px;
      box-sizing: border-box;
    }

    .loan-calculator-container input:focus,
    .loan-calculator-container select:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
    }

    .slider-container {
      margin-top: 10px;
    }

    .slider {
      -webkit-appearance: none;
      width: 100%;
      height: 8px;
      border-radius: 5px;
      background: #e9ecef;
      outline: none;
      padding: 0;
    }

    .slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 22px;
      height: 22px;
      border-radius: 50%;
      background: var(--primary);
      cursor: pointer;
      transition: var(--transition);
    }

    .slider::-webkit-slider-thumb:hover {
      background: var(--secondary);
      transform: scale(1.1);
    }

    .slider::-moz-range-thumb {
      width: 22px;
      height: 22px;
      border-radius: 50%;
      background: var(--primary);
      cursor: pointer;
      border: none;
    }

    .slider-values {
      display: flex;
      justify-content: space-between;
      margin-top: 5px;
      font-size: 0.85rem;
      color: var(--gray);
    }

    .btn-group {
      display: flex;
      gap: 15px;
      margin-top: 25px;
    }

    .loan-calculator-container button {
      flex: 1;
      padding: 14px;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .btn-calculate {
      background: var(--primary);
      color: white;
    }

    .btn-calculate:hover {
      background: var(--secondary);
      transform: translateY(-2px);
    }

    .btn-reset {
      background: var(--light);
      color: var(--gray);
      border: 2px solid #e9ecef;
    }

    .btn-reset:hover {
      background: #e9ecef;
      color: var(--dark);
    }

    .result-container {
      margin-top: 25px;
      background: #f8f9fa;
      border-radius: 12px;
      padding: 20px;
      display: none;
    }

    .result-container.visible {
      display: block;
      animation: fadeIn 0.5s ease;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .result-title {
      text-align: center;
      margin-bottom: 15px;
      font-weight: 600;
      color: var(--primary);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .result-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      margin-bottom: 20px;
    }

    .result-item {
      background: white;
      padding: 15px;
      border-radius: 12px;
      text-align: center;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
    }

    .result-value {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--primary);
      line-height: 1.2;
      word-break: break-word;
    }

    .result-label {
      font-size: 0.8rem;
      color: var(--gray);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-top: 5px;
    }

    .amortization {
      margin-top: 20px;
    }

    .amortization-title {
      font-weight: 600;
      margin-bottom: 10px;
      color: var(--secondary);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .amortization-chart {
      background: white;
      padding: 15px;
      border-radius: 12px;
    }

    .chart-bar {
      height: 30px;
      margin-bottom: 10px;
      border-radius: 4px;
      position: relative;
      display: flex;
      align-items: center;
    }

    .chart-bar.principal {
      background: var(--primary);
    }

    .chart-bar.interest {
      background: var(--accent);
    }

    .chart-label {
      padding-left: 10px;
      color: white;
      font-size: 0.9rem;
      font-weight: 600;
    }

    .footer {
      text-align: center;
      margin-top: 25px;
      font-size: 0.85rem;
      color: var(--gray);
      padding: 0 25px 25px;
    }

    .notification {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      padding: 12px 24px;
      border-radius: 8px;
      color: white;
      font-weight: 500;
      z-index: 1000;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      opacity: 0;
      transition: opacity 0.5s ease;
    }

    .notification.show {
      opacity: 1;
    }

    .notification.error {
      background: var(--danger);
    }

    @media (max-width: 480px) {
      .btn-group {
        flex-direction: column;
      }
      .result-grid {
        grid-template-columns: 1fr;
      }
      .loan-calculator-header h1 {
        font-size: 1.5rem;
      }
      .result-value {
        font-size: 1.2rem;
      }
    }
</style>

<div class="loan-calculator-container">
    <div class="loan-calculator-header">
        <h1><i class="fas fa-calculator"></i> भारतीय ऋण कैलकुलेटर</h1>
        <p>Calculate your loan payments in Indian Rupees</p>
    </div>

    <div class="loan-calculator-content">
        <div class="input-group">
            <label for="loanAmount"><i class="fas fa-rupee-sign"></i> Loan Amount (Rs.)</label>
            <div class="input-wrapper">
                <i class="fas fa-money-bill-wave"></i>
                <input type="number" id="loanAmount" placeholder="1000000" value="1000000" min="10000" max="10000000" step="1000">
            </div>
            <div class="slider-container">
                <input type="range" min="10000" max="10000000" value="1000000" class="slider" id="loanAmountSlider">
                <div class="slider-values">
                    <span>Rs. 10,000</span>
                    <span>Rs. 1,00,00,000</span>
                </div>
            </div>
        </div>

        <div class="input-group">
            <label for="interestRate"><i class="fas fa-percent"></i> Interest Rate (% per annum)</label>
            <div class="input-wrapper">
                <i class="fas fa-chart-line"></i>
                <input type="number" id="interestRate" placeholder="8.5" value="8.5" min="0" max="30" step="0.1">
            </div>
            <div class="slider-container">
                <input type="range" min="0" max="30" value="8.5" step="0.1" class="slider" id="interestRateSlider">
                <div class="slider-values">
                    <span>0%</span>
                    <span>30%</span>
                </div>
            </div>
        </div>

        <div class="input-group">
            <label for="loanTerm"><i class="fas fa-clock"></i> Loan Term (Years)</label>
            <div class="input-wrapper">
                <i class="fas fa-calendar-alt"></i>
                <input type="number" id="loanTerm" placeholder="15" value="15" min="1" max="30">
            </div>
            <div class="slider-container">
                <input type="range" min="1" max="30" value="15" class="slider" id="loanTermSlider">
                <div class="slider-values">
                    <span>1 year</span>
                    <span>30 years</span>
                </div>
            </div>
        </div>

        <div class="btn-group">
            <button class="btn-calculate" id="calculateBtn">
                <i class="fas fa-calculator"></i> Calculate
            </button>
            <button class="btn-reset" id="resetBtn">
                <i class="fas fa-redo"></i> Reset
            </button>
        </div>

        <div class="result-container" id="resultContainer">
            <div class="result-title">
                <i class="fas fa-file-invoice-dollar"></i> Loan Summary
            </div>

            <div class="result-grid">
                <div class="result-item">
                    <div class="result-value" id="monthlyPayment">Rs. 0</div>
                    <div class="result-label">Monthly Payment (EMI)</div>
                </div>
                <div class="result-item">
                    <div class="result-value" id="totalPayment">Rs. 0</div>
                    <div class="result-label">Total Payment</div>
                </div>
                <div class="result-item">
                    <div class="result-value" id="totalInterest">Rs. 0</div>
                    <div class="result-label">Total Interest</div>
                </div>
                <div class="result-item">
                    <div class="result-value" id="payoffTime">0 years</div>
                    <div class="result-label">Payoff Time</div>
                </div>
            </div>

            <div class="amortization">
                <div class="amortization-title">
                    <i class="fas fa-chart-pie"></i> Payment Breakdown
                </div>
                <div class="amortization-chart">
                    <div class="chart-bar principal" id="principalBar">
                        <span class="chart-label" id="principalLabel">Principal: 0%</span>
                    </div>
                    <div class="chart-bar interest" id="interestBar">
                        <span class="chart-label" id="interestLabel">Interest: 0%</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="footer">
        <p>© 2025 Indian Loan Calculator | Plan your finances wisely</p>
    </div>
</div>

<script>
    // Global variables to ensure clean execution
    window.loanCalculatorInitialized = false;
    
    if (!window.loanCalculatorInitialized) {
        window.loanCalculatorInitialized = true;
        
        // DOM Elements
        const loanAmountInput = document.getElementById("loanAmount");
        const loanAmountSlider = document.getElementById("loanAmountSlider");
        const interestRateInput = document.getElementById("interestRate");
        const interestRateSlider = document.getElementById("interestRateSlider");
        const loanTermInput = document.getElementById("loanTerm");
        const loanTermSlider = document.getElementById("loanTermSlider");
        const calculateBtn = document.getElementById("calculateBtn");
        const resetBtn = document.getElementById("resetBtn");
        const resultContainer = document.getElementById("resultContainer");
        const monthlyPaymentEl = document.getElementById("monthlyPayment");
        const totalPaymentEl = document.getElementById("totalPayment");
        const totalInterestEl = document.getElementById("totalInterest");
        const payoffTimeEl = document.getElementById("payoffTime");
        const principalBar = document.getElementById("principalBar");
        const interestBar = document.getElementById("interestBar");
        const principalLabel = document.getElementById("principalLabel");
        const interestLabel = document.getElementById("interestLabel");

        // Format number with Indian numbering system (Blogger safe)
        function formatIndianNumber(num) {
            if (typeof num !== 'number' || isNaN(num) || num === 0) {
                return '0';
            }
            
            // Round to avoid decimal issues
            const roundedNum = Math.round(num);
            const numStr = roundedNum.toString();
            
            // Handle negative numbers
            const isNegative = numStr.startsWith('-');
            const positiveNumStr = isNegative ? numStr.slice(1) : numStr;
            
            let result = '';
            const len = positiveNumStr.length;
            
            for (let i = 0; i < len; i++) {
                if (i > 0) {
                    const position = len - i;
                    // Add comma after 3 digits from right, then every 2 digits
                    if (position === 3 || (position > 3 && (position - 3) % 2 === 0)) {
                        result += ',';
                    }
                }
                result += positiveNumStr[i];
            }
            
            return isNegative ? '-' + result : result;
        }

        // Safe element update function
        function updateElement(element, value) {
            if (element && element.textContent !== undefined) {
                element.textContent = value;
            }
        }

        // Input/Slider Synchronization
        function syncSlider(input, slider) {
            const value = parseFloat(input.value);
            if (!isNaN(value) && slider) {
                slider.value = value;
            }
        }

        function syncInput(input, slider) {
            if (input && slider) {
                input.value = slider.value;
            }
        }

        // Event listeners for input/slider synchronization
        if (loanAmountInput && loanAmountSlider) {
            loanAmountInput.addEventListener('input', () => syncSlider(loanAmountInput, loanAmountSlider));
            loanAmountSlider.addEventListener('input', () => syncInput(loanAmountInput, loanAmountSlider));
        }
        
        if (interestRateInput && interestRateSlider) {
            interestRateInput.addEventListener('input', () => syncSlider(interestRateInput, interestRateSlider));
            interestRateSlider.addEventListener('input', () => syncInput(interestRateInput, interestRateSlider));
        }
        
        if (loanTermInput && loanTermSlider) {
            loanTermInput.addEventListener('input', () => syncSlider(loanTermInput, loanTermSlider));
            loanTermSlider.addEventListener('input', () => syncInput(loanTermInput, loanTermSlider));
        }

        // Calculate loan function
        function calculateLoan() {
            try {
                const loanAmount = parseFloat(loanAmountInput.value);
                const interestRate = parseFloat(interestRateInput.value);
                const loanTermYears = parseFloat(loanTermInput.value);

                // Validation
                if (isNaN(loanAmount) || loanAmount <= 0) {
                    showNotification("Please enter a valid loan amount.", "error");
                    return;
                }
                if (isNaN(interestRate) || interestRate < 0) {
                    showNotification("Please enter a valid interest rate.", "error");
                    return;
                }
                if (isNaN(loanTermYears) || loanTermYears <= 0) {
                    showNotification("Please enter a valid loan term.", "error");
                    return;
                }

                // Calculate EMI
                const interestRateMonthly = interestRate / 100 / 12;
                const loanTermMonths = loanTermYears * 12;

                let monthlyPayment;
                if (interestRate === 0) {
                    monthlyPayment = loanAmount / loanTermMonths;
                } else {
                    const factor = Math.pow(1 + interestRateMonthly, loanTermMonths);
                    monthlyPayment = (loanAmount * interestRateMonthly * factor) / (factor - 1);
                }

                const totalPayment = monthlyPayment * loanTermMonths;
                const totalInterest = totalPayment - loanAmount;

                // Display results with "Rs." prefix
                updateElement(monthlyPaymentEl, "Rs. " + formatIndianNumber(monthlyPayment));
                updateElement(totalPaymentEl, "Rs. " + formatIndianNumber(totalPayment));
                updateElement(totalInterestEl, "Rs. " + formatIndianNumber(totalInterest));
                updateElement(payoffTimeEl, loanTermYears + " year" + (loanTermYears > 1 ? "s" : ""));

                // Calculate percentages for breakdown
                const principalPercent = Math.round((loanAmount / totalPayment) * 100);
                const interestPercent = Math.round((totalInterest / totalPayment) * 100);

                // Update chart bars
                if (principalBar && interestBar && principalLabel && interestLabel) {
                    principalBar.style.width = principalPercent + "%";
                    interestBar.style.width = interestPercent + "%";
                    updateElement(principalLabel, "Principal: " + principalPercent + "%");
                    updateElement(interestLabel, "Interest: " + interestPercent + "%");
                }

                // Show results
                if (resultContainer) {
                    resultContainer.classList.add("visible");
                }

            } catch (error) {
                console.error("Calculation error:", error);
                showNotification("An error occurred during calculation.", "error");
            }
        }

        // Reset form function
        function resetForm() {
            try {
                if (loanAmountInput) loanAmountInput.value = 1000000;
                if (loanAmountSlider) loanAmountSlider.value = 1000000;
                if (interestRateInput) interestRateInput.value = 8.5;
                if (interestRateSlider) interestRateSlider.value = 8.5;
                if (loanTermInput) loanTermInput.value = 15;
                if (loanTermSlider) loanTermSlider.value = 15;

                // 
